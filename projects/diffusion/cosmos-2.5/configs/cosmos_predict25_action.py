config = dict(
    runners=['cosmos2_5.Cosmos25Trainer'],
    project_dir='./experiments/cosmos2_5/action',
    launch=dict(
        gpu_ids=[0, 1, 2, 3, 4, 5, 6, 7],
        distributed_type='DEEPSPEED',
        deepspeed_config=dict(
            deepspeed_config_file='accelerate_configs/zero2.json',
        ),
        until_completion=True,
    ),
    dataloaders=dict(
        train=dict(
            data_or_config=[
                '/path/to/packed_data',
            ],
            batch_size_per_gpu=1,
            num_workers=6,
            transform=dict(
                type='Cosmos25Transform',
                num_frames=13,
                height=256,
                width=320,
                image_cfg=dict(
                    mask_generator=dict(
                        max_cond_frames=1,
                        start=1,
                    ),
                ),
                action_cfg=dict(),
                fps=28,
            ),
            sampler=dict(
                type='DefaultSampler',
                shuffle=True,
            ),
        ),
    ),
    models=dict(
        vae_model_path='/path/to/cosmos2_5/vae',
        transformer_model_path='/path/to/cosmos2_5/models--nvidia--Cosmos-Predict2.5-2B/robot/action-cond/transformer',
    ),
    optimizers=dict(
        type='AdamW',
        lr=1e-6,
        weight_decay=0.001,
    ),
    schedulers=dict(
        type='ConstantScheduler',
    ),
    train=dict(
        resume=True,
        max_epochs=10,
        gradient_accumulation_steps=1,
        mixed_precision='bf16',  # fp16, bf16, fp8
        checkpoint_interval=500,
        checkpoint_total_limit=8,
        checkpoint_strict=False,
        log_with='tensorboard',
        log_interval=1,
        with_ema=True,
        activation_checkpointing=False,
        activation_class_names=['CosmosTransformerBlock'],
        cond_timestep=0,
        timestep_scale=0.001,
    ),
)
